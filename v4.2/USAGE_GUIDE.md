# CXN0102 ESP32C3 控制器 - 使用说明

## 问题：访问192.168.4.1没有网页

### 问题原因

代码使用SPIFFS文件系统存储网页文件，但您只烧录了主程序，**没有上传data目录中的文件系统数据**。

## 解决方法

### 方法1：使用VSCode PlatformIO扩展（推荐）

1. 在VSCode中打开项目
2. 点击左侧活动栏的 **PlatformIO** 图标（像蚂蚁的那个）
3. 在底部会出现PlatformIO终端
4. 执行以下命令：

**步骤1：上传文件系统（重要！）**
```
platformio run --target uploadfs
```

**步骤2：上传主程序**
```
platformio run --target upload
```

5. 等待上传完成，重启ESP32设备

---

### 方法2：使用VSCode图形界面

1. 点击左下角的 **"Project Tasks"** 按钮
2. 在弹出的菜单中，依次执行：
   - **Platform** → **Upload Filesystem Image** （上传文件系统）
   - **Platform** → **Upload** （上传主程序）
   
3. 等待上传完成，重启设备

---

### 方法3：使用命令行（如果PlatformIO CLI已安装）

打开命令提示符或PowerShell，在项目目录执行：

```bash
pio run -t uploadfs
pio run -t upload
```

---

## 上传成功后的使用步骤

### 1. 连接ESP32的热点
- ESP32启动后会创建一个WiFi热点
- **SSID**: `CXN0102_Web_Controller`
- **密码**: `12345678`

### 2. 访问网页控制界面
- 用手机或电脑连接上面的热点
- 打开浏览器访问：`http://192.168.4.1`
- 现在应该能看到控制界面了

### 3. 主要功能
- **基本控制**：启动/停止输入、重启、关机
- **光轴调整**：调整投影光轴
- **双相位调整**：调整双相位
- **梯形校正**：水平和垂直梯形校正、翻转模式
- **画质调整**：亮度、对比度、色调、饱和度、锐度
- **测试图案**：16种测试图案
- **自定义I2C命令**：发送自定义十六进制命令
- **风扇控制**：静音/正常/激进/自动模式
- **WiFi管理**：连接到家庭WiFi网络
- **系统信息**：温度、运行时间、版本信息等

---

## 连接到家庭WiFi（可选）

如果您想通过家庭WiFi访问控制器：

1. 在网页界面的"WiFi Management"区域：
   - 点击"Refresh Networks"扫描可用网络
   - 选择您的家庭网络
   - 输入WiFi密码（至少8位）
   - 点击"Save Credentials"保存
   - 点击"Switch to STA Mode (Reboot)"切换模式

2. ESP32会重启并连接到您的WiFi
3. 查看串口监视器（波特率115200）获取ESP32的IP地址
4. 使用该IP地址访问控制界面

---

## 硬件连接

- **SDA**: GPIO8
- **SCL**: GPIO7
- **BUTTON**: GPIO2（用于关机：按住按钮发送关机命令）
- **COM_REQ**: GPIO10（I2C中断信号）
- **FAN_PWM**: GPIO12（风扇PWM控制）

---

## 故障排除

### Q: 访问192.168.4.1仍然没有网页
**A**: 确认已经执行了"Upload Filesystem Image"步骤。在串口监视器中查看是否有"SPIFFS Mount Failed"错误。

### Q: ESP32启动后找不到热点
**A**: 检查串口监视器输出，确认AP模式是否正常启动。

### Q: 连接热点后无法访问
**A**: 
- 确认IP地址正确：`192.168.4.1`
- 确认设备已成功连接热点
- 尝试清除浏览器缓存或使用隐私模式

### Q: WiFi扫描失败
**A**: 
- 确保ESP32处于AP模式
- 等待几秒后再尝试扫描
- 查看串口监视器的错误信息

---

## 技术支持

- 查看串口监视器（波特率115200）获取详细日志
- 检查data/web_interface.html文件是否存在
- 确认ESP32-C3开发板正常工作

---

## 版本信息

- **固件版本**: V4.2
- **开发板**: ESP32-C3-DevKitM-1
- **平台**: espressif32
- **框架**: Arduino
